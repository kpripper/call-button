<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MERX Furniture</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.16/tailwind.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    <style>
      .telegram-button {
        background-color: #25cec8;
        color: white;
        padding: 12px 24px;
        border-radius: 4px;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;
        margin-top: 20px;
        cursor: pointer;
        border: none;
      }

      .telegram-button:hover {
        background-color: #25cec8;
      }

      .telegram-form {
        display: none;
        position: fixed;
        z-index: 1;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(0, 0, 0, 0.4);
      }

      .telegram-form-content {
        background-color: #9370db;
        margin: 15% auto;
        padding: 20px;
        border: 1px solid #8a2be2;
        width: 30%;
        color: white;
      }

      .telegram-float-btn {
        position: fixed;
        bottom: 40px;
        right: 40px;
        background-color: #0088cc; /* Telegram's signature blue */
        width: 60px;
        height: 60px;
        border-radius: 50%;
        text-align: center;
        box-shadow: 2px 2px 3px #999;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.3s;
        z-index: 1000;
      }

      .telegram-float-btn:hover {
        transform: scale(1.1);
        background-color: #0099dd; /* Lighter Telegram blue */
      }

      .telegram-float-btn i {
        color: white;
        font-size: 24px;
      }

      .telegram-form-content input {
        background-color: white;
        color: #333;
        border: 1px solid #8a2be2;
      }

      .telegram-form-content label {
        color: white;
      }

      .telegram-form-content h2 {
        color: white;
      }

      @media screen and (max-width: 768px) {
        .telegram-form-content {
          width: 90%;
          margin: 10% auto;
          padding: 15px;
        }

        .telegram-float-btn {
          bottom: 20px;
          right: 20px;
          width: 50px;
          height: 50px;
        }

        .telegram-float-btn i {
          font-size: 20px;
        }
      }
    </style>
  </head>
  <body>
    <!-- Your existing website content -->
    <div class="container mx-auto my-10">
      <div class="grid grid-cols-3 gap-4">
        <div class="bg-white shadow-lg rounded-lg p-4">
          <img
            src="https://images.unsplash.com/photo-1616486338812-3dadae4b4ace"
            alt="Їдальні"
            class="rounded-lg mb-4"
          />
          <h3 class="text-lg font-bold mb-2">Їдальні</h3>
          <p class="text-gray-600 mb-4">
            Знайдіть ідеальний обідній комплект для вашого простору.
          </p>
          <a
            href="#"
            class="bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-4 rounded-md inline-block"
            >Магазин їдалень</a
          >
        </div>

        <div class="bg-white shadow-lg rounded-lg p-4">
          <img
            src="https://images.unsplash.com/photo-1486946255434-2466348c2166"
            alt="Домашні офіси"
            class="rounded-lg mb-4"
          />
          <h3 class="text-lg font-bold mb-2">Домашні офіси</h3>
          <p class="text-gray-600 mb-4">
            Створіть продуктивне та надихаюче середовище домашнього офісу.
          </p>
          <a
            href="#"
            class="bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-4 rounded-md inline-block"
            >Магазин офісів</a
          >
        </div>

        <div class="bg-white shadow-lg rounded-lg p-4">
          <img
            src="https://images.unsplash.com/photo-1513519245088-0e12902e5a38"
            alt="Декор та аксесуари"
            class="rounded-lg mb-4"
          />
          <h3 class="text-lg font-bold mb-2">Декор та аксесуари</h3>
          <p class="text-gray-600 mb-4">
            Прикрасьте свій простір нашою ретельно підібраною колекцією декору
            та аксесуарів.
          </p>
          <a
            href="#"
            class="bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-4 rounded-md inline-block"
            >Магазин декору</a
          >
        </div>
      </div>
    </div>

    <!-- Telegram call form -->
    <div id="telegram-form" class="telegram-form">
      <div class="telegram-form-content">
        <h2 class="text-2xl font-bold mb-4">Замовити дзвінок</h2>
        <form id="telegram-call-form">
          <div class="mb-4">
            <label
              for="phone-number"
              class="block text-gray-700 font-medium mb-2"
              >Телефон</label
            >
            <input
              type="tel"
              id="phone-number"
              class="border border-gray-300 rounded-md px-4 py-2 w-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
              placeholder="Введіть номер телефону"
              pattern="(\+38[0-9]{10}|[0-9]{10})"
              title="Некоректний номер телефону"
              required
            />
          </div>
          <div class="mb-4">
            <label for="call-time" class="block text-gray-700 font-medium mb-2"
              >Коли зручніше отримати дзвінок?</label
            >
            <input
              type="time"
              id="call-time"
              class="border border-gray-300 rounded-md px-4 py-2 w-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
              required
            />
          </div>
          <button type="submit" class="telegram-button">Замовити</button>
          <button type="button" class="telegram-button" onclick="closeForm()">
            Скасувати
          </button>
        </form>
      </div>
    </div>

    <div
      class="telegram-float-btn"
      onclick="document.getElementById('telegram-form').style.display='block'"
    >
      <i class="fab fa-telegram"></i>
    </div>

    <script>
      function validateUkrainianPhone(phone) {
        const cleanPhone = phone.replace(/\D/g, "")

        const isValid =
          (cleanPhone.length === 12 && phone.startsWith("+38")) ||
          cleanPhone.length === 10

        if (!isValid) {
          return "Некоректний номер телефону"
        }
        return ""
      }

      function openForm() {
        document.getElementById("telegram-form").style.display = "block"
      }

      function closeForm() {
        document.getElementById("telegram-form").style.display = "none"
      }

      document
        .getElementById("telegram-call-form")
        .addEventListener("submit", async (event) => {
          event.preventDefault()
          const phoneInput = document.getElementById("phone-number")
          const callTime = document.getElementById("call-time").value
          const submitButton = event.target.querySelector(
            'button[type="submit"]'
          )

          // Validate phone number
          const phoneNumber = phoneInput.value
          const cleanPhone = phoneNumber.replace(/\D/g, "")
          if (
            !(
              (cleanPhone.length === 12 && cleanPhone.startsWith("+38")) ||
              cleanPhone.length === 10
            )
          ) {
            phoneInput.setCustomValidity(
              "Будь ласка, введіть коректний український номер телефону"
            )
            phoneInput.reportValidity()
            return
          }

          try {
            // Show loading state
            submitButton.disabled = true
            submitButton.textContent = "Відправляємо..."

            const response = await fetch("/telegram-call-bot", {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify({ phoneNumber, callTime }),
            })

            if (!response.ok) {
              throw new Error("Помилка мережі")
            }

            const data = await response.json()
            alert("Дякуємо! Ми зв'яжемося з вами найближчим часом.")
            closeForm()
          } catch (error) {
            alert("Дякуємо! Ми зв'яжемося з вами найближчим часом.")
            closeForm()
            console.error(error)
          } finally {
            submitButton.disabled = false
            submitButton.textContent = "Відправити"
          }
        })
    </script>
  </body>
</html>
